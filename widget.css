/* widget.css - refined UI + improved floating mascot + 3D optional */
:root{
  --primary: #059669;
  --bg: #fff;
  --muted: #6b7280;
  --panel-radius: 14px;
  --shadow: 0 20px 60px rgba(2,6,23,0.12);
  --ui-gap: 16px;
  --max-width: 920px;
  --font: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}

/* container */
.mascot-panel {
  position: fixed;
  right: 20px;
  bottom: 20px;
  width: var(--max-width);
  max-width: calc(100vw - 40px);
  background: var(--bg);
  border-radius: var(--panel-radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transform-origin: bottom right;
  transition: transform .22s ease, opacity .22s ease;
  z-index: 99999;
  border: 1px solid rgba(0,0,0,0.04);
  font-family: var(--font);
}

/* closed */
.mascot-panel.closed { transform: translateY(22px) scale(.98); opacity:0; pointer-events:none; height:0; }

/* header */
.panel-header { display:flex; justify-content:space-between; align-items:center; padding:18px; border-bottom:1px solid rgba(0,0,0,0.04); }
.brand{ display:flex; gap:12px; align-items:center; }
.logo{ width:46px; height:46px; border-radius:12px; background:var(--primary); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:16px; }
.meta .title{ font-weight:700; font-size:15px; }
.meta .subtitle{ font-size:12px; color:var(--muted); }

/* body layout */
.panel-body { display:flex; gap:18px; padding:18px; }
.left { width:300px; display:flex; flex-direction:column; gap:12px; align-items:center; }
.right { flex:1; display:flex; flex-direction:column; gap:12px; }

/* avatar */
.avatar-area { width:100%; display:flex; flex-direction:column; align-items:center; gap:10px; position:relative; }
.avatar-svg { width:150px; height:150px; border-radius:14px; box-shadow: 0 12px 36px rgba(2,6,23,0.06); }
.avatar-img { width:150px; height:150px; object-fit:cover; border-radius:14px; box-shadow: 0 12px 36px rgba(2,6,23,0.08); transition: transform .32s ease; }
.model-container { width:150px; height:150px; border-radius:12px; overflow:hidden; display:flex; align-items:center; justify-content:center; }

/* floating mascot (pop-out) */
.floating-mascot { position:absolute; left: calc(100% + 12px); top: 6px; width:140px; height:140px; z-index:120; display:flex; align-items:center; justify-content:center; pointer-events:none; transform-origin:center; transition:transform .28s cubic-bezier(.2,.9,.2,1), opacity .18s ease; opacity:0; }
.floating-mascot img { width:100%; height:100%; object-fit:cover; border-radius:12px; box-shadow: 0 20px 56px rgba(2,6,23,0.18); }
.floating-model { width:120px; height:120px; display:flex; align-items:center; justify-content:center; }
.floating-mascot.show { opacity:1; transform: translateX(-18px) translateY(-6px) scale(1.02); }
.hidden { display:none !important; }

/* chips & upload */
.chips { display:flex; flex-direction:column; gap:8px; width:100% }
.chip { padding:10px 12px; border-radius:12px; background:#fff; border:1px solid rgba(0,0,0,0.04); cursor:pointer; text-align:left; font-weight:600; }
.chip:hover { transform: translateY(-4px); box-shadow: 0 10px 26px rgba(2,6,23,0.06); }

/* upload */
.upload-label { cursor:pointer; display:block; margin-top:8px; }
.upload-btn { padding:10px 14px; border-radius:12px; background: linear-gradient(180deg, rgba(5,150,105,0.08), rgba(6,182,212,0.02)); color:var(--primary); border:1px dashed rgba(5,150,105,0.12); font-weight:700; }

/* chat */
.chat-body { background:#fbfffb; border-radius:12px; padding:16px; flex:1; overflow:auto; min-height:220px; max-height:480px; border:1px solid rgba(0,0,0,0.03); }
.message { display:flex; gap:12px; margin-bottom:14px; align-items:flex-end; }
.msg-user { margin-left:auto; background:white; padding:12px 14px; border-radius:12px; border:1px solid rgba(0,0,0,0.04); max-width:78%; box-shadow: 0 8px 28px rgba(2,6,23,0.04); font-size:14px; }
.msg-bot { margin-right:auto; background:linear-gradient(180deg, white, #f3fff6); padding:12px 14px; border-radius:12px; border:1px solid rgba(0,0,0,0.02); max-width:78%; font-size:14px; }

/* typing indicator */
.typing { display:flex; gap:6px; align-items:center; }
.dot { width:8px; height:8px; background:#94a3b8; border-radius:50%; opacity:0.9; animation: blink 1s infinite; }
.dot:nth-child(2){ animation-delay:.12s } .dot:nth-child(3){ animation-delay:.24s }
@keyframes blink { 0%{opacity:0.25; transform: translateY(0);} 50%{opacity:1; transform: translateY(-4px);} 100%{opacity:0.25; transform: translateY(0);} }

/* composer */
.composer { display:flex; gap:10px; align-items:flex-end; margin-top:6px; }
textarea#chat-input { flex:1; min-height:46px; max-height:140px; padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,0.06); resize:none; font-size:14px; }
.composer-actions { display:flex; flex-direction:column; gap:8px; }
.composer-mini { padding:8px 10px; border-radius:10px; border:1px solid rgba(0,0,0,0.06); background:white; cursor:pointer; }
.composer-send { background:var(--primary); color:white; padding:10px 14px; border-radius:12px; border:none; font-weight:700; cursor:pointer; }

/* footer & launcher */
.panel-footer { padding:10px 14px; border-top:1px solid rgba(0,0,0,0.04); font-size:13px; color:var(--muted); }
.mascot-toggle { position:fixed; right:18px; bottom:18px; z-index:999999; display:flex; gap:10px; align-items:center; padding:10px 14px; border-radius:999px; background:var(--primary); color:white; border:none; box-shadow:0 20px 60px rgba(2,6,23,0.16); cursor:pointer; }
.toggle-avatar { width:36px; height:36px; border-radius:999px; object-fit:cover; border:2px solid rgba(255,255,255,0.14); }

/* responsive */
@media (max-width:920px) {
  .mascot-panel { right:12px; left:12px; bottom:12px; width:auto; max-width: calc(100vw - 24px); }
  .left { display:none; }
}

/* floating animations for action choreography */
@keyframes dance { 0%{transform:translateY(0) rotate(0)}25%{transform:translateY(-10px) rotate(-6deg)}50%{transform:translateY(0) rotate(0)}75%{transform:translateY(-10px) rotate(6deg)}100%{transform:translateY(0) rotate(0)} }
.floating-mascot.dance { animation: dance .9s ease-in-out 3; }

@keyframes sing { 0%{transform:scaleY(1)}50%{transform:scaleY(1.06)}100%{transform:scaleY(1)} }
.floating-mascot.sing { animation: sing .7s linear 5; }

@keyframes walk { 0%{transform:translateX(0)}50%{transform:translateX(-36px)}100%{transform:translateX(0)} }
.floating-mascot.walk { animation: walk 1.1s ease-in-out 2; }

@keyframes wave { 0%{transform:rotate(0)}20%{transform:rotate(10deg)}40%{transform:rotate(-10deg)}60%{transform:rotate(8deg)}80%{transform:rotate(-8deg)}100%{transform:rotate(0)} }
.floating-mascot.wave { animation: wave .9s ease-in-out 3; }
